{% extends "dashboard/base.html" %}
{% load static %}

{% block title %}{% if object %}Edit{% else %}Add{% endif %} Product - Egyland Admin{% endblock %}

{% block extra_head %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.min.js"></script>
{% endblock %}

{% block header_title %}{% endblock %}
{% block breadcrumbs %}{% endblock %}
{% block header_actions %}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <!-- New improved header and breadcrumbs design -->
    <div class="bg-white shadow rounded-lg p-6 mb-6">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
            <div>
                <h1 class="text-2xl font-bold text-gray-800 mb-2">
                    {% if object %}Edit{% else %}Add{% endif %} Product
                </h1>
                <nav class="flex flex-wrap items-center text-sm text-gray-600">
                    <a href="{% url 'dashboard:home' %}" class="hover:text-primary transition">
                        <i class="fas fa-home"></i>
                        <span class="hidden sm:inline">Dashboard</span>
                    </a>
                    <i class="fas fa-chevron-right mx-2 text-gray-400"></i>
                    <span class="font-medium">Products</span>
                    <i class="fas fa-chevron-right mx-2 text-gray-400"></i>
                    <a href="{% url 'dashboard:products' %}" class="hover:text-primary transition">Product List</a>
                    <i class="fas fa-chevron-right mx-2 text-gray-400"></i>
                    <span class="text-primary font-medium">{% if object %}Edit{% else %}Add New{% endif %}</span>
                </nav>
            </div>
            <div class="mt-4 md:mt-0">
                <a href="{% url 'dashboard:products' %}" class="btn btn-outline">
                    <i class="fas fa-arrow-left mr-1"></i> Back to Products
                </a>
            </div>
        </div>
    </div>
    <!-- End of improved header and breadcrumbs -->
    
    <div class="mx-auto">
        <div class="bg-white shadow rounded-lg">
            <form method="post" enctype="multipart/form-data" class="p-6">
                {% csrf_token %}
                
                {% if messages %}
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        {% for message in messages %}
                            {% if message.tags == 'success' %}
                                toastr.success('{{ message }}');
                            {% elif message.tags == 'error' %}
                                toastr.error('{{ message }}');
                            {% elif message.tags == 'warning' %}
                                toastr.warning('{{ message }}');
                            {% else %}
                                toastr.info('{{ message }}');
                            {% endif %}
                        {% endfor %}
                    });
                </script>
                {% endif %}
                
                <!-- Form errors -->
                {% if form.non_field_errors %}
                <div class="mb-6">
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-4">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <i class="fas fa-exclamation-circle text-red-500"></i>
                            </div>
                            <div class="ml-3">
                                {% for error in form.non_field_errors %}
                                    <p class="text-sm text-red-700">{{ error }}</p>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Basic Information -->
                    <div class="md:col-span-2">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Basic Information</h3>
                    </div>
                    
                    <div class="md:col-span-2">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label for="id_name" class="block text-sm font-medium text-gray-700 mb-1">Product Name <span class="text-red-600">*</span></label>
                                <input type="text" name="name" id="id_name" value="{{ form.name.value|default:'' }}" 
                                      class="form-input" required>
                                {% if form.name.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.name.errors.0 }}</p>
                                {% endif %}
                            </div>
                            
                            <div>
                                <label for="id_product_type" class="block text-sm font-medium text-gray-700 mb-1">Product Type <span class="text-red-600">*</span></label>
                                <select name="product_type" id="id_product_type" class="form-input" required>
                                    {% for value, label in form.fields.product_type.choices %}
                                        <option value="{{ value }}" {% if form.product_type.value == value %}selected{% endif %}>
                                            {{ label }}
                                        </option>
                                    {% endfor %}
                                </select>
                                {% if form.product_type.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.product_type.errors.0 }}</p>
                                {% endif %}
                            </div>
                            
                            <!-- Product Order -->
                            <div>
                                <label for="id_order" class="block text-sm font-medium text-gray-700 mb-1">Display Order</label>
                                <input type="number" name="order" id="id_order" value="{{ form.order.value|default:'0' }}" class="form-input" min="0" step="1">
                                {% if form.order.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.order.errors.0 }}</p>
                                {% endif %}
                                <div class="mt-2 text-sm text-gray-500">
                                    Product display order (lower numbers appear first in product listings)
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="md:col-span-2" id="general_description_section">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="id_description" class="block text-sm font-medium text-gray-700 mb-1">General Description <span class="text-red-600 required-mark" style="display: none;">*</span></label>
                                <textarea name="description" id="id_description" rows="4" class="form-input" style="min-height: 250px;">{{ form.description.value|default:'' }}</textarea>
                                {% if form.description.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.description.errors.0 }}</p>
                                {% endif %}
                                <div class="mt-2 text-sm text-gray-500">
                                    General description that applies to general product type only.
                                </div>
                            </div>
                            
                            <!-- General Product Image -->
                            <div id="general_image_section">
                                <label for="id_fresh_image" class="block text-sm font-medium text-gray-700 mb-1">Product Detail Image</label>
                                <input type="file" name="fresh_image" id="id_fresh_image" class="form-input" accept="image/*">
                                {% if form.fresh_image.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.fresh_image.errors.0 }}</p>
                                {% endif %}
                                
                                {% if object.fresh_image %}
                                <div class="mt-2">
                                    <div class="flex items-center">
                                        <img src="{{ object.fresh_image.url }}" alt="Current product detail image" class="w-20 h-20 object-cover rounded">
                                        <span class="ml-2 text-sm text-gray-500">Current detail image</span>
                                    </div>
                                </div>
                                {% endif %}
                                <div class="mt-2 text-sm text-gray-500">
                                    Main product image displayed on the product detail page.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="md:col-span-2" id="fresh_description_section" style="display: none;">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="id_fresh_description" class="block text-sm font-medium text-gray-700 mb-1">Fresh Product Description <span class="text-red-600 required-mark" style="display: none;">*</span></label>
                                <textarea name="fresh_description" id="id_fresh_description" rows="4" class="form-input" style="min-height: 250px;">{{ form.fresh_description.value|default:'' }}</textarea>
                                {% if form.fresh_description.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.fresh_description.errors.0 }}</p>
                                {% endif %}
                                <div class="mt-2 text-sm text-gray-500">
                                    Specific description for Fresh products only.
                                </div>
                            </div>
                            
                            <!-- Fresh Image -->
                            <div id="fresh_image_section">
                                <label for="id_fresh_image" class="block text-sm font-medium text-gray-700 mb-1">Fresh Product Image</label>
                                <input type="file" name="fresh_image" id="id_fresh_image" class="form-input" accept="image/*">
                                {% if form.fresh_image.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.fresh_image.errors.0 }}</p>
                                {% endif %}
                                
                                {% if object.fresh_image %}
                                <div class="mt-2">
                                <div class="flex items-center">
                                        <img src="{{ object.fresh_image.url }}" alt="Current fresh product image" class="w-20 h-20 object-cover rounded">
                                        <span class="ml-2 text-sm text-gray-500">Current fresh product image</span>
                                    </div>
                                </div>
                                {% endif %}
                                <div class="mt-2 text-sm text-gray-500">
                                    Product image for fresh products. Will be displayed on product detail page.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="md:col-span-2" id="iqf_description_section" style="display: none;">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="id_iqf_description" class="block text-sm font-medium text-gray-700 mb-1">IQF Product Description <span class="text-red-600 required-mark" style="display: none;">*</span></label>
                                <textarea name="iqf_description" id="id_iqf_description" rows="4" class="form-input" style="min-height: 250px;">{{ form.iqf_description.value|default:'' }}</textarea>
                                {% if form.iqf_description.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.iqf_description.errors.0 }}</p>
                                {% endif %}
                                <div class="mt-2 text-sm text-gray-500">
                                    Specific description for IQF (frozen) products only.
                                </div>
                            </div>
                            
                            <!-- IQF Image -->
                            <div id="iqf_image_section">
                                <label for="id_iqf_image" class="block text-sm font-medium text-gray-700 mb-1">IQF Product Image</label>
                                <input type="file" name="iqf_image" id="id_iqf_image" class="form-input" accept="image/*">
                                {% if form.iqf_image.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.iqf_image.errors.0 }}</p>
                                {% endif %}
                                
                                {% if object.iqf_image %}
                                <div class="mt-2">
                                <div class="flex items-center">
                                        <img src="{{ object.iqf_image.url }}" alt="Current IQF product image" class="w-20 h-20 object-cover rounded">
                                        <span class="ml-2 text-sm text-gray-500">Current IQF product image</span>
                                    </div>
                                </div>
                                {% endif %}
                                <div class="mt-2 text-sm text-gray-500">
                                    Product image for IQF (frozen) products. Will be displayed on product detail page.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Product Features -->
                    <div class="md:col-span-2 mt-8">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Product Features</h3>
                    </div>
                    
                    <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow duration-200 bg-white relative">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center mr-3">
                                    <i class="fas fa-leaf text-indigo-600"></i>
                                </div>
                                <div class="flex-grow">
                                    <div class="flex items-center justify-between">
                                        <label for="id_has_varieties" class="block text-sm font-medium text-gray-700">
                                            Has Varieties
                                        </label>
                                        <div class="relative inline-block w-12 mr-2 align-middle select-none">
                                            <input type="checkbox" name="has_varieties" id="id_has_varieties" 
                                                {% if form.has_varieties.value %}checked{% endif %}
                                                class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer">
                                            <label for="id_has_varieties" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">
                                        If enabled, you can add different varieties of this product.
                                    </p>
                                </div>
                            </div>
                            {% if form.has_varieties.errors %}
                                <p class="text-red-600 text-sm mt-2">{{ form.has_varieties.errors.0 }}</p>
                            {% endif %}
                        </div>

                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow duration-200 bg-white relative">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                    <i class="fas fa-sort-numeric-down text-blue-600"></i>
                                </div>
                                <div class="flex-grow">
                                    <div class="flex items-center justify-between">
                                        <label for="id_has_counts" class="block text-sm font-medium text-gray-700">
                                            Has Counts
                                        </label>
                                        <div class="relative inline-block w-12 mr-2 align-middle select-none">
                                            <input type="checkbox" name="has_counts" id="id_has_counts" 
                                                {% if form.has_counts.value %}checked{% endif %}
                                                class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer">
                                            <label for="id_has_counts" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">
                                        If enabled, you can specify different count options for this product.
                                    </p>
                                </div>
                            </div>
                            {% if form.has_counts.errors %}
                                <p class="text-red-600 text-sm mt-2">{{ form.has_counts.errors.0 }}</p>
                            {% endif %}
                        </div>

                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow duration-200 bg-white relative">
                        <div class="flex items-center">
                                <div class="flex-shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                    <i class="fas fa-ruler-combined text-green-600"></i>
                                </div>
                                <div class="flex-grow">
                                    <div class="flex items-center justify-between">
                                        <label for="id_has_size" class="block text-sm font-medium text-gray-700">
                                            Has Size Options
                            </label>
                                        <div class="relative inline-block w-12 mr-2 align-middle select-none">
                                            <input type="checkbox" name="has_size" id="id_has_size" 
                                                {% if form.has_size.value %}checked{% endif %}
                                                class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer">
                                            <label for="id_has_size" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">
                                        If enabled, you can specify different size options for this product.
                                    </p>
                                </div>
                            </div>
                            {% if form.has_size.errors %}
                                <p class="text-red-600 text-sm mt-2">{{ form.has_size.errors.0 }}</p>
                            {% endif %}
                        </div>

                        <!-- Removed Has Packaging Options toggle -->
                        <input type="hidden" name="has_packaging" id="id_has_packaging" value="true">
                    </div>
                    
                    <!-- Options Selection -->
                    <div class="md:col-span-2 mt-8" id="predefined-options-header">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Predefined Options</h3>
                    </div>
                    
                    <div class="md:col-span-2">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <!-- Count Options -->
                            <div id="counts-container" class="border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow duration-200 bg-white" style="display:{% if form.has_counts.value %}block{% else %}none{% endif %};">
                                <div class="flex items-center justify-between mb-3">
                                    <div class="flex items-center">
                                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-2">
                                            <i class="fas fa-sort-numeric-down text-blue-600 text-sm"></i>
                                        </div>
                                        <label for="id_available_counts" class="block text-sm font-medium text-gray-700">Count Options</label>
                                    </div>
                                    <a href="{% url 'dashboard:counts' %}" class="text-blue-600 hover:text-blue-800 transition-colors text-sm" target="_blank" data-tooltip="Manage Count Options">
                                        <i class="fas fa-cog"></i>
                                    </a>
                                </div>
                                
                                <!-- Tag-based selection for counts -->
                                <div class="mb-3">
                                    <div class="flex flex-wrap gap-2 mb-2" id="selected-counts-container">
                                        {% for count in form.fields.available_counts.queryset|dictsort:"numeric_sort" %}
                                            {% if count.pk in form.available_counts.value %}
                                            <div class="count-tag bg-blue-100 text-blue-800 rounded-full px-3 py-1 text-sm flex items-center" data-value="{{ count.pk }}">
                                                <span>{{ count.display_value }}</span>
                                                <button type="button" class="ml-1 text-blue-600 hover:text-blue-800 focus:outline-none remove-tag" onclick="removeTag(this)">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                    
                                    <div class="relative">
                                        <select id="count-selector" class="form-input w-full">
                                            <option value="">Add a count option</option>
                                            {% for count in form.fields.available_counts.queryset|dictsort:"numeric_sort" %}
                                                <option value="{{ count.pk }}" data-display="{{ count.display_value }}">
                                                    {{ count.display_value }}
                                                </option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    
                                    <!-- Hidden input to store actual values -->
                                    <select name="available_counts" id="id_available_counts" class="hidden" multiple>
                                        {% for count in form.fields.available_counts.queryset|dictsort:"numeric_sort" %}
                                            {% if count.pk in form.available_counts.value %}
                                                <option value="{{ count.pk }}" selected>{{ count.display_value }}</option>
                                            {% endif %}
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                {% if form.available_counts.errors %}
                                    <p class="text-red-600 text-sm mt-2">{{ form.available_counts.errors.0 }}</p>
                                {% endif %}
                                
                                <div class="mt-2 text-xs text-gray-500 flex items-center">
                                    <i class="fas fa-info-circle text-blue-500 mr-1"></i>
                                    Select multiple count options for this product
                                </div>
                            </div>
                    
                            <!-- Size Options -->
                            <div id="sizes-container" class="border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow duration-200 bg-white" style="display:{% if form.has_size.value %}block{% else %}none{% endif %};">
                                <div class="flex items-center justify-between mb-3">
                                    <div class="flex items-center">
                                        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-2">
                                            <i class="fas fa-ruler-combined text-green-600 text-sm"></i>
                                        </div>
                                        <label for="id_available_sizes" class="block text-sm font-medium text-gray-700">Size Options</label>
                                    </div>
                                    <a href="{% url 'dashboard:sizes' %}" class="text-green-600 hover:text-green-800 transition-colors text-sm" target="_blank" data-tooltip="Manage Size Options">
                                        <i class="fas fa-cog"></i>
                                    </a>
                                </div>
                                
                                <!-- Tag-based selection for sizes -->
                                <div class="mb-3">
                                    <div class="flex flex-wrap gap-2 mb-2" id="selected-sizes-container">
                                        {% for size in form.fields.available_sizes.queryset %}
                                            {% if size.pk in form.available_sizes.value %}
                                            <div class="size-tag bg-green-100 text-green-800 rounded-full px-3 py-1 text-sm flex items-center" data-value="{{ size.pk }}">
                                                <span>{{ size.value }}</span>
                                                <button type="button" class="ml-1 text-green-600 hover:text-green-800 focus:outline-none remove-tag" onclick="removeTag(this)">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                    
                                    <div class="relative">
                                        <select id="size-selector" class="form-input w-full">
                                            <option value="">Add a size option</option>
                                            {% for size in form.fields.available_sizes.queryset %}
                                                <option value="{{ size.pk }}" data-display="{{ size.value }}">
                                                    {{ size.value }}
                                                </option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    
                                    <!-- Hidden input to store actual values -->
                                    <select name="available_sizes" id="id_available_sizes" class="hidden" multiple>
                                        {% for size in form.fields.available_sizes.queryset %}
                                            {% if size.pk in form.available_sizes.value %}
                                                <option value="{{ size.pk }}" selected>{{ size.value }}</option>
                                            {% endif %}
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                {% if form.available_sizes.errors %}
                                    <p class="text-red-600 text-sm mt-2">{{ form.available_sizes.errors.0 }}</p>
                                {% endif %}
                                
                                <div class="mt-2 text-xs text-gray-500 flex items-center">
                                    <i class="fas fa-info-circle text-green-500 mr-1"></i>
                                    Select multiple size options for this product
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Display Features -->
                    <div class="md:col-span-2 mt-4">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Display Features</h3>
                    </div>
                    
                    <!-- List Image, Button Color, and Seasonality Icon in one row -->
                    <div class="md:col-span-2 mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- List Image -->
                            <div>
                                <label for="id_list_image" class="block text-sm font-medium text-gray-700 mb-1">Product List Image</label>
                                <input type="file" name="list_image" id="id_list_image" class="form-input" accept="image/*">
                                {% if form.list_image.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.list_image.errors.0 }}</p>
                                {% endif %}
                                
                                {% if object.list_image %}
                                <div class="mt-2">
                                    <div class="flex items-center">
                                        <img src="{{ object.list_image.url }}" alt="Current product list image" class="w-20 h-20 object-cover rounded">
                                        <span class="ml-2 text-sm text-gray-500">Current list image</span>
                                    </div>
                                </div>
                                {% endif %}
                                <div class="mt-2 text-sm text-gray-500">
                                    Main product image displayed in product listings and search results. This image is used for all product types.
                                </div>
                            </div>
                            
                            <!-- Seasonality Icon -->
                            <div>
                                <label for="id_seasonality_icon" class="block text-sm font-medium text-gray-700 mb-1">Seasonality Icon</label>
                                <input type="file" name="seasonality_icon" id="id_seasonality_icon" class="form-input" accept="image/*">
                                {% if form.seasonality_icon.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.seasonality_icon.errors.0 }}</p>
                                {% endif %}
                                
                                {% if object.seasonality_icon %}
                                <div class="mt-2">
                                    <div class="flex items-center">
                                        <img src="{{ object.seasonality_icon.url }}" alt="Seasonality icon" class="w-20 h-20 object-cover rounded">
                                        <span class="ml-2 text-sm text-gray-500">Current seasonality icon</span>
                                    </div>
                                </div>
                                {% endif %}
                                <div class="mt-2 text-sm text-gray-500">
                                    Icon to be used in seasonality tables when no specific variety icon is selected.
                                </div>
                            </div>
                            
                            <!-- Button Color -->
                            <div>
                                <label for="id_button_color" class="block text-sm font-medium text-gray-700 mb-1">Button Color</label>
                                <div class="flex items-center">
                                    <input type="color" name="button_color" id="id_button_color" value="{{ form.button_color.value|default:'#39AE68' }}" 
                                           class="h-8 w-8 border-0 rounded">
                                    <input type="text" id="id_button_color_text" value="{{ form.button_color.value|default:'#39AE68' }}" 
                                           class="form-input ml-2" style="width: 100px;">
                                </div>
                                <div class="mt-2 text-sm text-gray-500">
                                    The color of the action buttons on product detail page. Choose a color that complements your product.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- SEO Information -->
                    <div class="md:col-span-2 mt-8">
                        <div class="border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow duration-200 bg-white relative">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mr-3">
                                    <i class="fas fa-search text-purple-600"></i>
                                </div>
                                <div class="flex-grow">
                                    <div class="flex items-center justify-between">
                                        <label for="id_has_seo" class="block text-sm font-medium text-gray-700">
                                            SEO Information
                                        </label>
                                        <div class="relative inline-block w-12 mr-2 align-middle select-none">
                                            <input type="checkbox" name="has_seo" id="id_has_seo" 
                                                {% if form.meta_title.value or form.meta_keywords.value or form.meta_description.value %}checked{% endif %}
                                                class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer">
                                            <label for="id_has_seo" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">
                                        Enable to customize SEO information for this product.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="seo-container" class="md:col-span-2" style="display:{% if form.meta_title.value or form.meta_keywords.value or form.meta_description.value %}block{% else %}none{% endif %};">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                            <div>
                                <label for="id_meta_title" class="block text-sm font-medium text-gray-700 mb-1">Meta Title</label>
                                <input type="text" name="meta_title" id="id_meta_title" value="{{ form.meta_title.value|default:'' }}" 
                                    class="form-input">
                                {% if form.meta_title.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.meta_title.errors.0 }}</p>
                                {% endif %}
                            </div>
                            
                            <div>
                                <label for="id_meta_keywords" class="block text-sm font-medium text-gray-700 mb-1">Meta Keywords</label>
                                <input type="text" name="meta_keywords" id="id_meta_keywords" value="{{ form.meta_keywords.value|default:'' }}" 
                                    class="form-input">
                                {% if form.meta_keywords.errors %}
                                    <p class="text-red-600 text-sm mt-1">{{ form.meta_keywords.errors.0 }}</p>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label for="id_meta_description" class="block text-sm font-medium text-gray-700 mb-1">Meta Description</label>
                            <textarea name="meta_description" id="id_meta_description" rows="3" class="form-input" style="min-height: 150px;">{{ form.meta_description.value|default:'' }}</textarea>
                            {% if form.meta_description.errors %}
                                <p class="text-red-600 text-sm mt-1">{{ form.meta_description.errors.0 }}</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Additional Product Images -->
                    <div class="md:col-span-2 mt-8">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Additional Product Images</h3>
                    </div>
                    
                    <!-- Background images row -->
                    <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="id_background_left" class="block text-sm font-medium text-gray-700 mb-1">Background Left</label>
                            <input type="file" name="background_left" id="id_background_left" class="form-input" accept="image/*">
                            {% if form.background_left.errors %}
                                <p class="text-red-600 text-sm mt-1">{{ form.background_left.errors.0 }}</p>
                            {% endif %}
                            
                            {% if object.background_left %}
                            <div class="mt-2">
                                <div class="flex items-center">
                                    <img src="{{ object.background_left.url }}" alt="Current left background" class="w-16 h-16 object-contain rounded">
                                    <span class="ml-2 text-sm text-gray-500">Current background</span>
                                </div>
                            </div>
                            {% endif %}
                            <div class="mt-2 text-sm text-gray-500">
                                Decorative background image on the left side of product detail page.
                            </div>
                        </div>
                        
                        <div>
                            <label for="id_background_right" class="block text-sm font-medium text-gray-700 mb-1">Background Right</label>
                            <input type="file" name="background_right" id="id_background_right" class="form-input" accept="image/*">
                            {% if form.background_right.errors %}
                                <p class="text-red-600 text-sm mt-1">{{ form.background_right.errors.0 }}</p>
                            {% endif %}
                            
                            {% if object.background_right %}
                            <div class="mt-2">
                                <div class="flex items-center">
                                    <img src="{{ object.background_right.url }}" alt="Current right background" class="w-16 h-16 object-contain rounded">
                                    <span class="ml-2 text-sm text-gray-500">Current background</span>
                                </div>
                            </div>
                            {% endif %}
                            <div class="mt-2 text-sm text-gray-500">
                                Decorative background image on the right side of product detail page.
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Action buttons -->
                <div class="mt-8 flex justify-end space-x-3">
                    <a href="{% url 'dashboard:products' %}" class="btn btn-outline">
                        <i class="fas fa-times mr-1"></i> Cancel
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save mr-1"></i> {% if object %}Update{% else %}Create{% endif %}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Sync color input with text value
        const colorInput = document.getElementById('id_button_color');
        const colorText = document.getElementById('id_button_color_text');
        
        colorInput.addEventListener('input', function() {
            colorText.value = this.value;
        });
        
        colorText.addEventListener('input', function() {
            colorInput.value = this.value;
        });
        
        // Function to remove tags
        function removeTag(button) {
            const tag = button.closest('.tag-item, .count-tag, .size-tag, .packaging-tag');
            if (!tag) return;
            
            // Identify tag type and container
            let containerid = '';
            let hiddenInputId = '';
            let selectorId = '';
            
            if (tag.classList.contains('count-tag')) {
                containerid = 'selected-counts-container';
                hiddenInputId = 'id_available_counts';
                selectorId = 'count-selector';
            } else if (tag.classList.contains('size-tag')) {
                containerid = 'selected-sizes-container';
                hiddenInputId = 'id_available_sizes';
                selectorId = 'size-selector';
            } else if (tag.classList.contains('packaging-tag')) {
                containerid = 'selected-packaging-container';
                hiddenInputId = 'id_available_packaging';
                selectorId = 'packaging-selector';
            }
            
            // Get value before removing
            const value = tag.dataset.value;
            
            // Remove tag
            tag.remove();
            
            // Update hidden input
            updateHiddenInput(containerid, hiddenInputId);
            
            // Get dropdown element
            const selector = document.getElementById(selectorId);
            if (selector) {
                // Re-enable corresponding option
                Array.from(selector.options).forEach(option => {
                    if (option.value === value) {
                        option.disabled = false;
                        option.style.display = '';
                    }
                });
            }
            
            // Sort count tags if needed
            if (containerid === 'selected-counts-container') {
                sortCountTags();
            }
        }
        
        // Make function globally available
        window.removeTag = removeTag;
        
        // Function to sort count tags
        function sortCountTags() {
            const container = document.getElementById('selected-counts-container');
            if (!container) return;
            
            const tags = Array.from(container.querySelectorAll('.count-tag'));
            if (tags.length <= 1) return; // No need to sort for 0 or 1 tag
            
            // Sort based on numeric value
            tags.sort((a, b) => {
                const textA = a.querySelector('span').textContent;
                const textB = b.querySelector('span').textContent;
                
                // Extract numbers from text
                const matchA = textA.match(/\d+/g);
                const matchB = textB.match(/\d+/g);
                
                // If no numbers, compare as text
                if (!matchA || !matchB) {
                    return textA.localeCompare(textB);
                }
                
                // Use first number for comparison (usually the main one)
                const numA = parseInt(matchA[0]);
                const numB = parseInt(matchB[0]);
                
                return numA - numB; // Ascending order
            });
            
            // Empty container and add sorted tags
            container.innerHTML = '';
            tags.forEach(tag => container.appendChild(tag));
        }
        
        // Make updateHiddenInput available globally
        window.updateHiddenInput = function(containerId, hiddenInputId) {
            const container = document.getElementById(containerId);
            const hiddenInput = document.getElementById(hiddenInputId);
            
            if (!container || !hiddenInput) return;
            
            // Clear existing options
            while (hiddenInput.options.length > 0) {
                hiddenInput.remove(0);
            }
            
            // Add new options based on tags
            Array.from(container.querySelectorAll('.tag-item, .count-tag, .size-tag, .packaging-tag')).forEach(tag => {
                const value = tag.dataset.value;
                const display = tag.querySelector('span').textContent;
                
                const option = document.createElement('option');
                option.value = value;
                option.textContent = display;
                option.selected = true;
                
                hiddenInput.appendChild(option);
            });
        };
        
        // Make updateDropdownOptions available globally
        window.updateDropdownOptions = function(selector, container) {
            if (!selector || !container) return;
            
            // Get all selected values
            const selectedValues = Array.from(container.querySelectorAll('.tag-item, .count-tag, .size-tag, .packaging-tag')).map(tag => tag.dataset.value);
            
            // Update all options state
            Array.from(selector.options).forEach(option => {
                if (option.value === '') return; // Skip empty option
                
                if (selectedValues.includes(option.value)) {
                    option.disabled = true;
                    option.style.display = 'none';
                } else {
                    option.disabled = false;
                    option.style.display = '';
                }
            });
        };
        
        // Add setupTagSelector function
        function setupTagSelector(selectorId, containerId, hiddenInputId) {
            const selector = document.getElementById(selectorId);
            const container = document.getElementById(containerId);
            const hiddenInput = document.getElementById(hiddenInputId);
            
            if (!selector || !container || !hiddenInput) return;
            
            // Initialize dropdown
            updateDropdownOptions(selector, container);
            
            selector.addEventListener('change', function() {
                if (!this.value) return;
                
                const option = this.options[this.selectedIndex];
                const value = this.value;
                const display = option.getAttribute('data-display') || option.textContent;
                
                // Create tag element
                const tagElement = document.createElement('div');
                tagElement.className = selectorId.includes('count') ? 'count-tag tag-item bg-blue-100 text-blue-800 rounded-full px-3 py-1 text-sm flex items-center' : 
                                    selectorId.includes('size') ? 'size-tag tag-item bg-green-100 text-green-800 rounded-full px-3 py-1 text-sm flex items-center' :
                                    'packaging-tag tag-item bg-yellow-100 text-yellow-800 rounded-full px-3 py-1 text-sm flex items-center';
                tagElement.dataset.value = value;
                
                tagElement.innerHTML = `
                    <span>${display}</span>
                    <button type="button" class="ml-1 hover:text-red-600 focus:outline-none remove-tag" onclick="removeTag(this)">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                // Add to container
                container.appendChild(tagElement);
                
                // Update hidden input
                updateHiddenInput(containerId, hiddenInputId);
                
                // Sort count tags if this is the counts container
                if (containerId === 'selected-counts-container') {
                    sortCountTags();
                }
                
                // Update dropdown options
                updateDropdownOptions(selector, container);
                
                // Reset dropdown
                this.value = '';
            });
        }
        
        // Initialize tag selectors
        setupTagSelector('count-selector', 'selected-counts-container', 'id_available_counts');
        setupTagSelector('size-selector', 'selected-sizes-container', 'id_available_sizes');
        setupTagSelector('packaging-selector', 'selected-packaging-container', 'id_available_packaging');
        
        // Sort count tags on page load
        sortCountTags();
        
        // Function to control options visibility
        function updateOptionsVisibility() {
            // Get checkbox state
            const hasCountsChecked = document.getElementById('id_has_counts').checked;
            const hasSizesChecked = document.getElementById('id_has_size').checked;
            const hasSeoChecked = document.getElementById('id_has_seo').checked;
            
            // Get sections
            const countsContainer = document.getElementById('counts-container');
            const sizesContainer = document.getElementById('sizes-container');
            const seoContainer = document.getElementById('seo-container');
            const optionsHeader = document.getElementById('predefined-options-header');
            
            // Update counts section visibility
            countsContainer.style.display = hasCountsChecked ? 'block' : 'none';
            
            // Update sizes section visibility
            sizesContainer.style.display = hasSizesChecked ? 'block' : 'none';
            
            // Update SEO section visibility
            seoContainer.style.display = hasSeoChecked ? 'block' : 'none';
            
            // Update predefined options header - now always visible due to Packaging section
            optionsHeader.style.display = 'block';
        }
        
        // Add event listeners to checkboxes
        document.getElementById('id_has_counts').addEventListener('change', updateOptionsVisibility);
        document.getElementById('id_has_size').addEventListener('change', updateOptionsVisibility);
        document.getElementById('id_has_seo').addEventListener('change', updateOptionsVisibility);
        
        // Call function immediately to ensure correct display on page load
        updateOptionsVisibility();
        
        // Handle product type change to show/hide description fields
        const productTypeSelect = document.getElementById('id_product_type');
        const generalDescSection = document.getElementById('general_description_section');
        const freshDescSection = document.getElementById('fresh_description_section');
        const iqfDescSection = document.getElementById('iqf_description_section');
        
        // Create a visual editor for any textarea
        const createVisualEditor = function(textarea) {
            if (!textarea) return null;
            
            // Check if already has editor
            if (textarea.parentNode.querySelector('.visual-editor-container')) {
                return textarea.parentNode.querySelector('.visual-editor-container');
            }
            
            // Hide the original textarea but keep it for form submission
            textarea.style.display = 'none';
            
            // Create editor container with unique class based on textarea id
            const editorContainer = document.createElement('div');
            editorContainer.className = 'visual-editor-container';
            // Add identifier class based on textarea id
            if (textarea.id) {
                editorContainer.classList.add(textarea.id + '-editor');
            }
            
            // Create toolbar
            const toolbar = document.createElement('div');
            toolbar.className = 'visual-editor-toolbar flex items-center p-2 bg-gray-100 border border-gray-300 rounded-t';
            toolbar.innerHTML = `
                <button type="button" data-command="bold" class="p-1 mr-1 rounded hover:bg-gray-200" title="Bold">
                    <i class="fas fa-bold"></i>
                </button>
                <button type="button" data-command="italic" class="p-1 mr-1 rounded hover:bg-gray-200" title="Italic">
                    <i class="fas fa-italic"></i>
                </button>
                <button type="button" data-command="underline" class="p-1 mr-2 rounded hover:bg-gray-200" title="Underline">
                    <i class="fas fa-underline"></i>
                </button>
                <div class="border-r border-gray-300 h-6 mr-2"></div>
                <button type="button" data-command="formatBlock" data-value="h2" class="p-1 mr-1 rounded hover:bg-gray-200" title="Heading">
                    <i class="fas fa-heading"></i>
                </button>
                <button type="button" data-command="formatBlock" data-value="p" class="p-1 mr-2 rounded hover:bg-gray-200" title="Paragraph">
                    <i class="fas fa-paragraph"></i>
                </button>
                <div class="border-r border-gray-300 h-6 mr-2"></div>
                <button type="button" data-command="insertUnorderedList" class="p-1 mr-1 rounded hover:bg-gray-200" title="Bullet List">
                    <i class="fas fa-list-ul"></i>
                </button>
                <button type="button" data-command="insertOrderedList" class="p-1 mr-2 rounded hover:bg-gray-200" title="Numbered List">
                    <i class="fas fa-list-ol"></i>
                </button>
                <div class="border-r border-gray-300 h-6 mr-2"></div>
                <button type="button" data-command="createLink" class="p-1 mr-1 rounded hover:bg-gray-200" title="Insert Link">
                    <i class="fas fa-link"></i>
                </button>
                <button type="button" data-command="unlink" class="p-1 mr-2 rounded hover:bg-gray-200" title="Remove Link">
                    <i class="fas fa-unlink"></i>
                </button>
                <div class="border-r border-gray-300 h-6 mr-2"></div>
                <button type="button" data-command="undo" class="p-1 mr-1 rounded hover:bg-gray-200" title="Undo">
                    <i class="fas fa-undo"></i>
                </button>
                <button type="button" data-command="redo" class="p-1 mr-1 rounded hover:bg-gray-200" title="Redo">
                    <i class="fas fa-redo"></i>
                </button>
            `;
            
            // Create editable content area
            const editableContent = document.createElement('div');
            editableContent.className = 'visual-editor-content border border-gray-300 rounded-b p-3';
            editableContent.style.minHeight = '250px';
            editableContent.style.maxHeight = '500px';
            editableContent.style.overflowY = 'auto';
            editableContent.contentEditable = true;
            editableContent.innerHTML = textarea.value;
            
            // Add paste event listener to handle formatted paste
            editableContent.addEventListener('paste', function(e) {
                // Prevent the default paste behavior
                e.preventDefault();
                
                // Get clipboard data
                const clipboardData = e.clipboardData || window.clipboardData;
                
                // Try to get HTML content first, fallback to text
                const pastedData = clipboardData.getData('text/html') || clipboardData.getData('text');
                
                // Insert at cursor position with formatting
                document.execCommand('insertHTML', false, pastedData);
                
                // Update the original textarea with the edited content
                textarea.value = editableContent.innerHTML;
            });
            
            // Add components to container
            editorContainer.appendChild(toolbar);
            editorContainer.appendChild(editableContent);
            
            // Insert editor after textarea
            textarea.parentNode.insertBefore(editorContainer, textarea.nextSibling);
            
            // Add event listeners to toolbar buttons
            toolbar.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const command = this.getAttribute('data-command');
                    
                    if (command === 'createLink') {
                        const url = prompt('Enter URL:', 'https://');
                        if (url) {
                            document.execCommand(command, false, url);
                        }
                    } 
                    else if (this.hasAttribute('data-value')) {
                        document.execCommand(command, false, this.getAttribute('data-value'));
                    } 
                    else {
                        document.execCommand(command, false, null);
                    }
                    
                    // Update the original textarea with the edited content
                    textarea.value = editableContent.innerHTML;
                });
            });
            
            // Update textarea when content changes
            editableContent.addEventListener('input', function() {
                textarea.value = this.innerHTML;
            });
            
            // Update textarea on form submit (extra safety)
            const form = textarea.closest('form');
            if (form) {
                form.addEventListener('submit', function() {
                    textarea.value = editableContent.innerHTML;
                });
            }
            
            return editorContainer;
        };
        
        // Function to remove visual editor
        const removeVisualEditor = function(textarea) {
            if (!textarea) return;
            
            const editorContainer = textarea.parentNode.querySelector('.visual-editor-container');
            if (editorContainer) {
                editorContainer.remove();
                textarea.style.display = 'block';
            }
        };
        
        // Apply visual editors to all description textareas
        function setupAllVisualEditors() {
            // Apply to visible textareas only
            const visibleSections = [
                generalDescSection.style.display !== 'none' ? document.getElementById('id_description') : null,
                freshDescSection.style.display !== 'none' ? document.getElementById('id_fresh_description') : null,
                iqfDescSection.style.display !== 'none' ? document.getElementById('id_iqf_description') : null,
                document.getElementById('id_meta_description')
            ].filter(el => el !== null);
            
            // Create editors for visible textareas
            visibleSections.forEach(textarea => {
                createVisualEditor(textarea);
            });
        }
        
        function updateDescriptionFields() {
            const selectedType = productTypeSelect.value;
            const descriptionInput = document.getElementById('id_description');
            const freshDescInput = document.getElementById('id_fresh_description');
            const iqfDescInput = document.getElementById('id_iqf_description');
            const requiredMarks = document.querySelectorAll('.required-mark');
            
            // Reset all fields
            descriptionInput.required = false;
            freshDescInput.required = false;
            iqfDescInput.required = false;
            
            // Handle General Description and Image - only show for general type
            if (selectedType === 'general') {
                generalDescSection.style.display = 'block';
                // No longer required
                requiredMarks[0].style.display = 'none';
            } else {
                generalDescSection.style.display = 'none';
                requiredMarks[0].style.display = 'none';
                // Remove editor if section is hidden
                removeVisualEditor(descriptionInput);
            }
            
            // Handle Fresh Description
            if ((selectedType === 'fresh' || selectedType === 'both') && selectedType !== 'general') {
                freshDescSection.style.display = 'block';
                
                // Make required if it's the only description field or for both
                if (selectedType === 'fresh' || selectedType === 'both') {
                    freshDescInput.required = true;
                    freshDescSection.querySelector('.required-mark').style.display = 'inline';
                } else {
                    freshDescSection.querySelector('.required-mark').style.display = 'none';
                }
            } else {
                freshDescSection.style.display = 'none';
                // Remove editor if section is hidden
                removeVisualEditor(freshDescInput);
            }
            
            // Handle IQF Description
            if ((selectedType === 'iqf' || selectedType === 'both') && selectedType !== 'general') {
                iqfDescSection.style.display = 'block';
                
                // Make required if it's the only description field or for both
                if (selectedType === 'iqf' || selectedType === 'both') {
                    iqfDescInput.required = true;
                    iqfDescSection.querySelector('.required-mark').style.display = 'inline';
                } else {
                    iqfDescSection.querySelector('.required-mark').style.display = 'none';
                }
            } else {
                iqfDescSection.style.display = 'none';
                // Remove editor if section is hidden
                removeVisualEditor(iqfDescInput);
            }
            
            // Setup visual editors for visible textareas after updating visibility
            setTimeout(setupAllVisualEditors, 10);
        }
        
        // Initial call to set the correct state
        updateDescriptionFields();
        
        // Listen for changes
        productTypeSelect.addEventListener('change', updateDescriptionFields);
        
        // Initialize SEO section editor
        document.getElementById('id_has_seo').addEventListener('change', function() {
            const seoContainer = document.getElementById('seo-container');
            if (this.checked) {
                seoContainer.style.display = 'block';
                // Set up visual editor for meta description
                setTimeout(() => {
                    createVisualEditor(document.getElementById('id_meta_description'));
                }, 10);
            } else {
                seoContainer.style.display = 'none';
                removeVisualEditor(document.getElementById('id_meta_description'));
            }
        });
    });
</script>
{% endblock %}

{% block extra_css %}
<style>
    /* Styles for toggle switches */
    .toggle-checkbox {
        transition: .4s;
        border-color: #d1d5db;
    }
    .toggle-checkbox:checked {
        transform: translateX(100%);
        border-color: #38a169;
    }
    .toggle-label {
        transition: background-color .4s;
    }
    input:checked + .toggle-label {
        background-color: #38a169;
    }
    
    /* Improved Select2 styling */
    .select2-container--default .select2-selection--multiple {
        border-color: #d1d5db !important;
        border-radius: 0.375rem !important;
        min-height: 38px !important;
    }
    
    .select2-container--default.select2-container--focus .select2-selection--multiple {
        border-color: #60a5fa !important;
        box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.2) !important;
    }
    
    .select2-container--default .select2-selection--multiple .select2-selection__choice {
        background-color: #f3f4f6 !important;
        border-color: #e5e7eb !important;
        border-radius: 0.25rem !important;
        padding: 0.25rem 0.5rem !important;
        margin-top: 4px !important;
        margin-right: 4px !important;
    }
    
    .select2-container--default .select2-results__option--highlighted[aria-selected] {
        background-color: #4f46e5 !important;
    }
    
    /* Tooltip styling */
    [data-tooltip]:hover:after {
        content: attr(data-tooltip);
        position: absolute;
        background-color: #1f2937;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        z-index: 10;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        margin-bottom: 8px;
    }
    
    /* Visual editor styling */
    .visual-editor-toolbar button {
        min-width: 28px;
        min-height: 28px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    .visual-editor-toolbar button:hover {
        background-color: #e5e7eb;
    }
    
    .visual-editor-toolbar button:active {
        background-color: #d1d5db;
    }
    
    .visual-editor-content {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        line-height: 1.5;
    }
    
    .visual-editor-content:focus {
        outline: none;
        border-color: #60a5fa;
        box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.2);
    }
    
    .visual-editor-content h2 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-top: 1rem;
        margin-bottom: 0.5rem;
    }
    
    .visual-editor-content p {
        margin-bottom: 0.5rem;
    }
    
    .visual-editor-content ul, 
    .visual-editor-content ol {
        padding-left: 1.5rem;
        margin-bottom: 0.5rem;
    }
    
    .visual-editor-content a {
        color: #2563eb;
        text-decoration: underline;
    }
    
    /* Transition effects */
    .border {
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    
    .border:hover {
        border-color: #a5b4fc;
    }
</style>
{% endblock %} 